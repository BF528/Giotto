<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • Giotto</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-109153024-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-109153024-2');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Giotto</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Start
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting_started.html#description">Description</a>
    </li>
    <li>
      <a href="../articles/getting_started.html#workflow-diagram">Workflow</a>
    </li>
    <li>
      <a href="../articles/getting_started.html#howtos">HOWTOs</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Datasets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/mouse_seqFISH_cortex_200319.html">mouse seqFISH cortex</a>
    </li>
    <li>
      <a href="../articles/mouse_merFISH_hypoth_preoptic_region_200326.html">mouse hypoth. preopt. region</a>
    </li>
    <li>
      <a href="../articles/mouse_starmap_cortex.html">mouse STARmap cortex</a>
    </li>
    <li>
      <a href="../articles/human_cycif_PDAC_200322.html">human CyCIF PDAC</a>
    </li>
    <li>
      <a href="../articles/mouse_visium_brain_200325.html">mouse Visium brain</a>
    </li>
    <li>
      <a href="../articles/mouse_visium_kidney_200326.html">mouse Visium kidney</a>
    </li>
    <li>
      <a href="../articles/mouse_CODEX_spleen.html">mouse CODEX spleen</a>
    </li>
    <li>
      <a href="../articles/mouse_osmFISH_SScortex.html">mouse osmFISH SScortex</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/faqs.html">FAQ</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/RubD/Giotto">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RubD/Giotto/blob/master/vignettes/howto_voronoi_plots.Rmd"><code>vignettes/howto_voronoi_plots.Rmd</code></a></small>
      <div class="hidden name"><code>howto_voronoi_plots.Rmd</code></div>

    </div>

    
    
<div id="voronoi-plots-to-visualize-spatial-data" class="section level1">
<h1 class="hasAnchor">
<a href="#voronoi-plots-to-visualize-spatial-data" class="anchor"></a>Voronoi plots to visualize spatial data</h1>
<p>Voronoi plots are an attractive way to visualize spatial expression data since it reduces whitespace between single cells or spots, however the voronoi borders do NOT necessarily mimick the true cell borders. Nevertheless it has been used to ‘segment’ cells and assign transcripts to individual cells. Here we merely use it as a beautifull visualization alternative to simple ‘points’.</p>
<div id="start-with-the-analysis-of-the-mini-seqfish-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#start-with-the-analysis-of-the-mini-seqfish-dataset" class="anchor"></a>1. Start with the analysis of the mini seqFISH+ dataset</h2>
<ul>
<li>this dataset is part of the Giotto package</li>
<li>it’s very small and easy to run</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(Giotto)</a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co"># input data</span></a>
<a class="sourceLine" id="cb1-4" title="4">VC_exprs_small =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"seqfish_field_expr.txt"</span>, <span class="dt">package =</span> <span class="st">'Giotto'</span>))</a>
<a class="sourceLine" id="cb1-5" title="5">VC_locs_small =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"seqfish_field_locs.txt"</span>, <span class="dt">package =</span> <span class="st">'Giotto'</span>))</a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co"># giotto object</span></a>
<a class="sourceLine" id="cb1-8" title="8">VC_small &lt;-<span class="st"> </span><span class="kw"><a href="../reference/createGiottoObject.html">createGiottoObject</a></span>(<span class="dt">raw_exprs =</span> VC_exprs_small, <span class="dt">spatial_locs =</span> VC_locs_small, <span class="dt">instructions =</span> instrs)</a>
<a class="sourceLine" id="cb1-9" title="9">VC_small &lt;-<span class="st"> </span><span class="kw"><a href="../reference/filterGiotto.html">filterGiotto</a></span>(<span class="dt">gobject =</span> VC_small, <span class="dt">expression_threshold =</span> <span class="fl">0.5</span>, <span class="dt">gene_det_in_min_cells =</span> <span class="dv">0</span>, <span class="dt">min_det_genes_per_cell =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1-10" title="10">VC_small &lt;-<span class="st"> </span><span class="kw"><a href="../reference/normalizeGiotto.html">normalizeGiotto</a></span>(<span class="dt">gobject =</span> VC_small, <span class="dt">scalefactor =</span> <span class="dv">6000</span>, <span class="dt">verbose =</span> T)</a>
<a class="sourceLine" id="cb1-11" title="11">VC_small &lt;-<span class="st"> </span><span class="kw"><a href="../reference/addStatistics.html">addStatistics</a></span>(<span class="dt">gobject =</span> VC_small)</a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co"># clustering</span></a>
<a class="sourceLine" id="cb1-14" title="14">VC_small &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calculateHVG.html">calculateHVG</a></span>(<span class="dt">gobject =</span> VC_small)</a>
<a class="sourceLine" id="cb1-15" title="15">gene_metadata =<span class="st"> </span><span class="kw"><a href="../reference/fDataDT.html">fDataDT</a></span>(VC_small)</a>
<a class="sourceLine" id="cb1-16" title="16">featgenes =<span class="st"> </span>gene_metadata[hvg <span class="op">==</span><span class="st"> 'yes'</span> <span class="op">&amp;</span><span class="st"> </span>perc_cells <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span> <span class="op">&amp;</span><span class="st"> </span>mean_expr_det <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>]<span class="op">$</span>gene_ID</a>
<a class="sourceLine" id="cb1-17" title="17">VC_small &lt;-<span class="st"> </span><span class="kw"><a href="../reference/runPCA.html">runPCA</a></span>(<span class="dt">gobject =</span> VC_small, <span class="dt">genes_to_use =</span> featgenes, <span class="dt">scale_unit =</span> F)</a>
<a class="sourceLine" id="cb1-18" title="18">VC_small &lt;-<span class="st"> </span><span class="kw"><a href="../reference/runUMAP.html">runUMAP</a></span>(VC_small, <span class="dt">dimensions_to_use =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">n_threads =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-19" title="19">VC_small &lt;-<span class="st"> </span><span class="kw"><a href="../reference/createNearestNetwork.html">createNearestNetwork</a></span>(<span class="dt">gobject =</span> VC_small, <span class="dt">dimensions_to_use =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">k =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb1-20" title="20">VC_small &lt;-<span class="st"> </span><span class="kw"><a href="../reference/doLeidenCluster.html">doLeidenCluster</a></span>(<span class="dt">gobject =</span> VC_small, <span class="dt">resolution =</span> <span class="fl">0.4</span>, <span class="dt">n_iterations =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb1-21" title="21"></a>
<a class="sourceLine" id="cb1-22" title="22"><span class="co"># spatial grid and network</span></a>
<a class="sourceLine" id="cb1-23" title="23">VC_small =<span class="st"> </span><span class="kw"><a href="../reference/createSpatialNetwork.html">createSpatialNetwork</a></span>(<span class="dt">gobject =</span> VC_small, <span class="dt">minimum_k =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-24" title="24">VC_small =<span class="st"> </span><span class="kw"><a href="../reference/createSpatialGrid.html">createSpatialGrid</a></span>(<span class="dt">gobject =</span> VC_small, <span class="dt">sdimx_stepsize =</span> <span class="dv">500</span>, <span class="dt">sdimy_stepsize =</span> <span class="dv">500</span>)</a></code></pre></div>
</div>
<div id="voronoi-plot-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#voronoi-plot-examples" class="anchor"></a>2. Voronoi plot examples</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># spatial voronoi plot with selected clusters</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="../reference/spatPlot.html">spatPlot</a></span>(VC_small, <span class="dt">point_shape =</span> <span class="st">'voronoi'</span>, <span class="dt">cell_color =</span><span class="st">'leiden_clus'</span>, <span class="dt">select_cell_groups =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb2-3" title="3">         <span class="dt">save_plot =</span> T, <span class="dt">save_param =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">save_name =</span> <span class="st">'1_voronoi'</span>))</a></code></pre></div>
<p><img src="../inst/howtos/voronoi_plots/vignette_1/1_voronoi.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># spatial voronoi plot without showing not selected clusters</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw"><a href="../reference/spatPlot.html">spatPlot</a></span>(VC_small, <span class="dt">point_shape =</span> <span class="st">'voronoi'</span>, <span class="dt">cell_color =</span><span class="st">'leiden_clus'</span>, <span class="dt">select_cell_groups =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">show_other_cells =</span> F,</a>
<a class="sourceLine" id="cb3-3" title="3">         <span class="dt">save_plot =</span> T, <span class="dt">save_param =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">save_name =</span> <span class="st">'2_voronoi_no_others'</span>))</a></code></pre></div>
<p><img src="../inst/howtos/voronoi_plots/vignette_1/2_voronoi_no_others.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># spatial voronoi plot without showing not selected cells, but showing the voronoi borders</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw"><a href="../reference/spatPlot.html">spatPlot</a></span>(VC_small, <span class="dt">point_shape =</span> <span class="st">'voronoi'</span>, <span class="dt">cell_color =</span><span class="st">'leiden_clus'</span>, <span class="dt">select_cell_groups =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">show_other_cells =</span> F, <span class="dt">vor_border_color =</span> <span class="st">'black'</span>,</a>
<a class="sourceLine" id="cb4-3" title="3">         <span class="dt">save_plot =</span> T, <span class="dt">save_param =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">save_name =</span> <span class="st">'3_voronoi_no_others_black_border'</span>))</a></code></pre></div>
<p><img src="../inst/howtos/voronoi_plots/vignette_1/3_voronoi_no_others_black_border.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># visualization of both dimension reduction and spatial results</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw"><a href="../reference/spatDimPlot.html">spatDimPlot</a></span>(<span class="dt">gobject =</span> VC_small, <span class="dt">cell_color =</span> <span class="st">'leiden_clus'</span>, <span class="dt">spat_point_shape =</span> <span class="st">'voronoi'</span>, <span class="dt">dim_point_size =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb5-3" title="3">            <span class="dt">save_plot =</span> T, <span class="dt">save_param =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">save_name =</span> <span class="st">'4_voronoi_spat_dim'</span>, <span class="dt">base_height =</span> <span class="dv">8</span>))</a></code></pre></div>
<p><img src="../inst/howtos/voronoi_plots/vignette_1/4_voronoi_spat_dim.png" style="width:50.0%"></p>
</div>
<div id="create-neighbors-and-show-neighbors" class="section level2">
<h2 class="hasAnchor">
<a href="#create-neighbors-and-show-neighbors" class="anchor"></a>3. Create neighbors and show neighbors</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">nb_annot =<span class="st"> </span><span class="kw"><a href="../reference/findNetworkNeighbors.html">findNetworkNeighbors</a></span>(VC_small, </a>
<a class="sourceLine" id="cb6-2" title="2">                            <span class="dt">spatial_network_name =</span> <span class="st">'Delaunay_network'</span>, </a>
<a class="sourceLine" id="cb6-3" title="3">                            <span class="dt">source_cell_ids =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'cell_1'</span>, <span class="st">'cell_6'</span>, <span class="st">'cell_10'</span>, <span class="st">'cell_91'</span>, <span class="st">'cell_92'</span>, <span class="st">'cell_93'</span>))</a>
<a class="sourceLine" id="cb6-4" title="4">VC_small =<span class="st"> </span><span class="kw"><a href="../reference/addCellMetadata.html">addCellMetadata</a></span>(VC_small, <span class="dt">new_metadata =</span> nb_annot, <span class="dt">by_column =</span> T, <span class="dt">column_cell_ID =</span> <span class="st">'cell_ID'</span>)</a>
<a class="sourceLine" id="cb6-5" title="5"></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="kw"><a href="../reference/spatPlot.html">spatPlot</a></span>(VC_small, <span class="dt">point_shape =</span> <span class="st">'voronoi'</span>, <span class="dt">cell_color =</span><span class="st">'nb_cells'</span>,</a>
<a class="sourceLine" id="cb6-7" title="7">         <span class="dt">cell_color_code =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">source =</span> <span class="st">'blue'</span>, <span class="dt">target =</span> <span class="st">'red'</span>, <span class="dt">both =</span> <span class="st">'yellow'</span>, <span class="dt">others =</span> <span class="st">'lightgrey'</span>),</a>
<a class="sourceLine" id="cb6-8" title="8">         <span class="dt">save_plot =</span> T, <span class="dt">save_param =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">save_name =</span> <span class="st">'5_voronoi_neighbors'</span>))</a></code></pre></div>
<p><img src="../inst/howtos/voronoi_plots/vignette_1/5_voronoi_neighbors.png" style="width:50.0%"></p>
</div>
<div id="gene-expression-and-voronoi-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#gene-expression-and-voronoi-plots" class="anchor"></a>4. Gene expression and voronoi plots</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co">## overlay gene expression information ##</span></a>
<a class="sourceLine" id="cb7-2" title="2">selected_genes =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'Cldn5'</span>, <span class="st">'Soga3'</span>)</a>
<a class="sourceLine" id="cb7-3" title="3"></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co"># selected genes original</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="kw"><a href="../reference/spatGenePlot.html">spatGenePlot</a></span>(<span class="dt">gobject =</span> VC_small, <span class="dt">expression_values =</span> <span class="st">'scaled'</span>, <span class="dt">genes =</span> selected_genes, <span class="dt">point_size =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb7-6" title="6">             <span class="dt">save_plot =</span> T, <span class="dt">save_param =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">save_name =</span> <span class="st">'6_original_points'</span>, <span class="dt">base_width =</span> <span class="dv">10</span>, <span class="dt">base_heigth =</span> <span class="dv">5</span>))</a></code></pre></div>
<p><img src="../inst/howtos/voronoi_plots/vignette_1/6_original_points.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># selected genes voronoi</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw"><a href="../reference/spatGenePlot.html">spatGenePlot</a></span>(<span class="dt">gobject =</span> VC_small, <span class="dt">genes =</span> selected_genes, <span class="dt">point_shape =</span> <span class="st">'voronoi'</span>,</a>
<a class="sourceLine" id="cb8-3" title="3">             <span class="dt">expression_values =</span> <span class="st">'scaled'</span>, <span class="dt">vor_border_color =</span> <span class="st">'black'</span>,</a>
<a class="sourceLine" id="cb8-4" title="4">             <span class="dt">save_plot =</span> T, <span class="dt">save_param =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">save_name =</span> <span class="st">'7_voronoi_genes'</span>, <span class="dt">base_width =</span> <span class="dv">10</span>, <span class="dt">base_heigth =</span> <span class="dv">5</span>))</a></code></pre></div>
<p><img src="../inst/howtos/voronoi_plots/vignette_1/7_voronoi_genes.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># one gene + black background and white borders</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw"><a href="../reference/spatGenePlot.html">spatGenePlot</a></span>(<span class="dt">gobject =</span> VC_small, <span class="dt">genes =</span> <span class="st">'Cldn5'</span>, <span class="dt">point_size =</span> <span class="dv">3</span>, <span class="dt">point_shape =</span> <span class="st">'voronoi'</span>,</a>
<a class="sourceLine" id="cb9-3" title="3">             <span class="dt">expression_values =</span> <span class="st">'scaled'</span>, <span class="dt">vor_border_color =</span> <span class="st">'white'</span>, <span class="dt">show_network =</span> T, <span class="dt">network_color =</span> <span class="st">'green'</span>,</a>
<a class="sourceLine" id="cb9-4" title="4">             <span class="dt">background_color =</span> <span class="st">'black'</span>, <span class="dt">cell_color_gradient =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'blue'</span>, <span class="st">'black'</span>, <span class="st">'red'</span>), <span class="dt">gradient_midpoint =</span> <span class="dv">1</span>, <span class="dt">cow_n_col =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb9-5" title="5">             <span class="dt">save_plot =</span> T, <span class="dt">save_param =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">save_name =</span> <span class="st">'8_voronoi_gene_black_bg'</span>))</a></code></pre></div>
<p><img src="../inst/howtos/voronoi_plots/vignette_1/8_voronoi_gene_black_bg.png" style="width:50.0%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#voronoi-plots-to-visualize-spatial-data">Voronoi plots to visualize spatial data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#start-with-the-analysis-of-the-mini-seqfish-dataset">1. Start with the analysis of the mini seqFISH+ dataset</a></li>
      <li><a href="#voronoi-plot-examples">2. Voronoi plot examples</a></li>
      <li><a href="#create-neighbors-and-show-neighbors">3. Create neighbors and show neighbors</a></li>
      <li><a href="#gene-expression-and-voronoi-plots">4. Gene expression and voronoi plots</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.rubendries.com/">Ruben Dries</a>, Huipeng Li, Qian Zhu, Rui Dong, Guo-Cheng Yuan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
